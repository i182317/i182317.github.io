<!DOCTYPE html>
<html>
	<head>
		<title>nlefort - js - deplacement carre</title>
	</head>

	<body>

		<canvas id="animatedElem"></canvas>

	</body>

	<script>
	
		theCanvas = document.getElementById("animatedElem");
        var ctx = theCanvas.getContext('2d');
        ctx.canvas.width  = window.innerWidth;
        ctx.canvas.height = window.innerHeight;
        theCanvas.addEventListener('keydown', doKeyDown, true);

        var img = new Image();
		img.src="./../src/image/hero_walk_cycle_spritesheet_by_mrnoobtastic-d3defej.png";
		img.addEventListener('load', function() {
			// start the mainloop
			animFrame(recursiveAnim);
		});


        var i = 0;
        var x = 0;
        var y = 0;

	    function drawGame() {
            ctx.clearRect(x, y, 128, 128);
            ctx.drawImage(img, 128*i, 0, 128,128,x,y,128,128 );
	    }

	    function updateGame() {
			i++;
            if( i > 4){
                i = 0;
            }	
	    }

	    function doKeyDown(e) {
	    	e.preventDefault();
	    	console.log("test");
	    	if (e.keyCode == 40) {
				y = y + 10;
			}

			if (e.keyCode == 38) {
				y = y - 10;
			}

			if (e.keyCode == 37) {
				x = x - 10;
			}

			if (e.keyCode == 39) {
				x = x + 10;
    
            }	    
        }
		
		var mainloop = function() {
			updateGame();
	        drawGame();
   		};

	    var animFrame = window.requestAnimationFrame ||
	            window.webkitRequestAnimationFrame ||
	            window.mozRequestAnimationFrame    ||
	            window.oRequestAnimationFrame      ||
	            window.msRequestAnimationFrame     ||
	            null ;

	    var recursiveAnim = function() {
	        mainloop();
	        animFrame(recursiveAnim);
	    };

	</script>
</html>